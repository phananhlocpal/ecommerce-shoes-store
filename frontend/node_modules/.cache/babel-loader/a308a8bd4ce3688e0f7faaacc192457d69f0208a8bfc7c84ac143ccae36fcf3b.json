{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport axios from 'axios';\nimport { variables } from '../../utils/api/variables.js';\n\n// Ngưỡng miễn phí giao hàng\nexport const DELIVERY_THRESHOLD = 1200;\n\n// Thunk để tải cart từ database hoặc sessionStorage\nexport const loadCart = createAsyncThunk('cart/loadCart', async currentUser => {\n  if (currentUser) {\n    const response = await axios.get(`${variables.CART_ITEM_API}/${currentUser.customerID}`);\n    console.log('response from item database', response.data);\n    // Lặp qua danh sách các items và xử lý mỗi item\n    const cartItems = response.data && response.data.length > 0 ? response.data.map(item => ({\n      cartItemID: item.cartItemID,\n      customerID: item.customerID,\n      product: item.product,\n      productPrice: item.productPrice,\n      productSizeID: item.productSizeID,\n      productSize: item.productSizeName,\n      quantity: item.quantity\n    })) : [];\n    console.log('cartItems:', cartItems);\n    return cartItems || [];\n  } else {\n    // Lấy dữ liệu từ sessionStorage\n    const localCart = sessionStorage.getItem('cartItems');\n    if (!localCart) {\n      // Tạo một cart rỗng nếu chưa có\n      const emptyCart = [];\n      sessionStorage.setItem('cartItems', JSON.stringify(emptyCart));\n      console.log('No localCart found. Initialized empty cart:', emptyCart);\n      return emptyCart;\n    }\n    console.log('localCart:', localCart);\n    return JSON.parse(localCart);\n  }\n});\nconst cartSlice = createSlice({\n  name: 'cart',\n  initialState: {\n    items: [],\n    subtotal: 0,\n    delivery: 0,\n    discount: 0,\n    total: 0\n  },\n  reducers: {\n    addToCart: (state, action) => {\n      const {\n        cartItemID,\n        customerID,\n        product,\n        productPrice,\n        productSizeID,\n        productSize,\n        quantity = 1,\n        currentUser\n      } = action.payload;\n\n      // Check if the product with the same id and size already exists in the cart\n      const existingItem = state.items.find(item => item.product.productID === product.productID && item.productSize === productSize);\n      if (existingItem && existingItem.productSizeID === productSizeID) {\n        // If the item exists, increase the quantity\n        existingItem.quantity += quantity;\n        const cartItemID = existingItem.cartItemID;\n        if (currentUser) {\n          axios.put(`${variables.CART_ITEM_API}/${cartItemID}`, {\n            customerID: currentUser.customerID,\n            productSizeID: productSizeID,\n            quantity: existingItem.quantity\n          }).then(() => console.log('Cart item updated in database')).catch(err => console.error('Error updating cart item:', err));\n        } else {\n          // If the user is not authenticated, save to session\n          sessionStorage.setItem('cartItems', JSON.stringify(state.items));\n        }\n      } else {\n        // If the item doesn't exist, add a new item to the cart\n        state.items.push({\n          cartItemID,\n          customerID,\n          product,\n          productPrice,\n          productSizeID,\n          productSize,\n          quantity\n        });\n        if (currentUser) {\n          const newCartItem = {\n            customerId: currentUser.customerID,\n            quantity: quantity,\n            productSizeID: productSizeID\n          };\n          console.log(newCartItem);\n          // Send the POST request to the backend to save the cart item to the database\n          axios.post(`${variables.CART_ITEM_API}`, newCartItem).then(() => console.log('Cart item saved to database')).catch(err => console.error('Error saving cart item:', err));\n        } else {\n          // If the user is not authenticated, save to sessionStorage\n          sessionStorage.setItem('cartItems', JSON.stringify(state.items));\n        }\n      }\n    },\n    removeFromCart: (state, action) => {\n      const {\n        cartItemID,\n        productID,\n        productSize,\n        currentUser\n      } = action.payload;\n      console.log('Removing product:', productID);\n      // Tìm item cần xóa\n      const itemToRemove = state.items.find(item => item.product.productID === productID && item.productSize === productSize);\n      if (!itemToRemove) {\n        console.error(\"Item to remove not found in cart\");\n        return;\n      }\n\n      // Cập nhật state.items\n      state.items = state.items.filter(item => item.product.productID !== productID || item.productSize !== productSize);\n      console.log('Current cart items after removal:', state.items);\n      if (currentUser) {\n        axios.delete(`${variables.CART_ITEM_API}/${cartItemID}`).then(() => console.log('Cart item removed from database')).catch(err => console.error('Error removing cart item:', err));\n      } else {\n        sessionStorage.setItem('cartItems', JSON.stringify(state.items));\n      }\n\n      // Tự động tính lại subtotal, delivery, và total sau khi xóa\n      const subtotal = state.items.reduce((acc, item) => acc + item.price * item.quantity, 0);\n      state.subtotal = subtotal;\n      state.delivery = subtotal >= DELIVERY_THRESHOLD ? 0 : 60;\n      state.total = subtotal + state.delivery - state.subtotal * state.discount;\n    },\n    updateQuantity: (state, action) => {\n      const {\n        cartItemID,\n        customerID,\n        product,\n        productPrice,\n        productSizeID,\n        productSize,\n        quantity,\n        currentUser\n      } = action.payload;\n      // Find the index of the item in the cart\n      const cartItemIndex = state.items.findIndex(item => item.product.productID === product.productID && item.productSize === productSize);\n      if (cartItemIndex !== -1) {\n        // Update the quantity of the existing item (create a new state for immutability)\n        state.items[cartItemIndex] = {\n          ...state.items[cartItemIndex],\n          quantity: quantity\n        };\n        if (currentUser) {\n          // Only update the specific cart item in the database\n          const updatedCartItem = state.items[cartItemIndex];\n          const updatedItem = {\n            cartItemID: updatedCartItem.cartItemID,\n            customerID: currentUser.customerID,\n            productSizeID: productSizeID,\n            quantity: updatedCartItem.quantity\n          };\n\n          // Send the updated cart item to the server\n          axios.put(`${variables.CART_ITEM_API}/${updatedCartItem.cartItemID}`, updatedItem).then(() => console.log('Cart item updated in database')).catch(err => console.error('Error updating cart item:', err));\n        } else {\n          // If the user is not authenticated, update sessionStorage\n          sessionStorage.setItem('cartItems', JSON.stringify(state.items));\n        }\n      }\n    },\n    clearCart: (state, action) => {\n      const {\n        currentUser\n      } = action.payload;\n      state.items = [];\n      if (currentUser) {\n        axios.delete(`${variables.CART_API}`).then(() => console.log('Cart cleared in database')).catch(err => console.error('Error clearing cart:', err));\n      } else {\n        sessionStorage.removeItem('cartItems');\n      }\n    },\n    calculateSubtotal: state => {\n      const subtotal = state.items.reduce((acc, item) => acc + item.productPrice * item.quantity, 0);\n      if (subtotal >= DELIVERY_THRESHOLD) {\n        state.delivery = 0;\n        state.subtotal = subtotal;\n      } else {\n        state.delivery = 60;\n        state.subtotal = subtotal;\n      }\n    },\n    updateDelivery: (state, action) => {\n      state.delivery = action.payload.deliveryCost;\n    },\n    applyDiscount: (state, action) => {\n      state.discount = action.payload.discount;\n    },\n    getTotal: state => {\n      state.total = state.subtotal - state.subtotal * state.discount + state.delivery;\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(loadCart.fulfilled, (state, action) => {\n      console.log('Cart loaded from database:', action.payload);\n      state.items = action.payload;\n    });\n  }\n});\nexport const {\n  addToCart,\n  removeFromCart,\n  updateQuantity,\n  clearCart,\n  calculateSubtotal,\n  updateDelivery,\n  applyDiscount,\n  getTotal\n} = cartSlice.actions;\nexport default cartSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","variables","DELIVERY_THRESHOLD","loadCart","currentUser","response","get","CART_ITEM_API","customerID","console","log","data","cartItems","length","map","item","cartItemID","product","productPrice","productSizeID","productSize","productSizeName","quantity","localCart","sessionStorage","getItem","emptyCart","setItem","JSON","stringify","parse","cartSlice","name","initialState","items","subtotal","delivery","discount","total","reducers","addToCart","state","action","payload","existingItem","find","productID","put","then","catch","err","error","push","newCartItem","customerId","post","removeFromCart","itemToRemove","filter","delete","reduce","acc","price","updateQuantity","cartItemIndex","findIndex","updatedCartItem","updatedItem","clearCart","CART_API","removeItem","calculateSubtotal","updateDelivery","deliveryCost","applyDiscount","getTotal","extraReducers","builder","addCase","fulfilled","actions","reducer"],"sources":["C:/Users/Surface/Documents/Pal/myproject/ecommerce-shoes-store/frontend/src/store/reducers/cartSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport axios from 'axios';\nimport { variables } from '../../utils/api/variables.js';\n\n\n// Ngưỡng miễn phí giao hàng\nexport const DELIVERY_THRESHOLD = 1200;\n\n// Thunk để tải cart từ database hoặc sessionStorage\nexport const loadCart = createAsyncThunk('cart/loadCart', async (currentUser) => {\n    if (currentUser) {\n    const response = await axios.get(`${variables.CART_ITEM_API}/${currentUser.customerID}`);\n    console.log('response from item database', response.data);\n    // Lặp qua danh sách các items và xử lý mỗi item\n    const cartItems = (response.data && response.data.length > 0) ?\n      response.data.map(item => ({\n        cartItemID: item.cartItemID,\n        customerID: item.customerID,\n        product: item.product,\n        productPrice: item.productPrice,\n        productSizeID: item.productSizeID,\n        productSize: item.productSizeName,\n        quantity: item.quantity,\n      })) : [];\n    console.log('cartItems:', cartItems);\n\n    return cartItems || [];\n  } else {\n    // Lấy dữ liệu từ sessionStorage\n    const localCart = sessionStorage.getItem('cartItems');\n\n    if (!localCart) {\n      // Tạo một cart rỗng nếu chưa có\n      const emptyCart = [];\n      sessionStorage.setItem('cartItems', JSON.stringify(emptyCart));\n      console.log('No localCart found. Initialized empty cart:', emptyCart);\n      return emptyCart;\n    }\n\n    console.log('localCart:', localCart);\n    return JSON.parse(localCart);\n  }\n});\n\nconst cartSlice = createSlice({\n  name: 'cart',\n  initialState: {\n    items: [],\n    subtotal: 0,\n    delivery: 0,\n    discount: 0,\n    total: 0,\n  },\n  reducers: {\n    addToCart: (state, action) => {\n      const { cartItemID, customerID, product, productPrice, productSizeID, productSize, quantity = 1, currentUser } = action.payload;\n    \n      // Check if the product with the same id and size already exists in the cart\n      const existingItem = state.items.find(\n        (item) => item.product.productID === product.productID && item.productSize === productSize\n      );\n    \n      if (existingItem && existingItem.productSizeID === productSizeID) {\n        // If the item exists, increase the quantity\n        existingItem.quantity += quantity;\n\n        const cartItemID = existingItem.cartItemID;\n        if (currentUser) {\n          axios\n            .put(`${variables.CART_ITEM_API}/${cartItemID}`, {\n              customerID: currentUser.customerID,\n              productSizeID: productSizeID,\n              quantity: existingItem.quantity,\n            })\n            .then(() => console.log('Cart item updated in database'))\n            .catch((err) => console.error('Error updating cart item:', err));\n        } else {\n          // If the user is not authenticated, save to session\n          sessionStorage.setItem('cartItems', JSON.stringify(state.items));\n        }\n      } else {\n        // If the item doesn't exist, add a new item to the cart\n        state.items.push({ cartItemID, customerID, product, productPrice, productSizeID, productSize, quantity  });\n    \n        if (currentUser) {\n    \n          const newCartItem = {\n            customerId: currentUser.customerID,\n            quantity: quantity,\n            productSizeID: productSizeID,\n          };\n          \n          console.log(newCartItem)\n          // Send the POST request to the backend to save the cart item to the database\n          axios\n            .post(`${variables.CART_ITEM_API}`, newCartItem)\n            .then(() => console.log('Cart item saved to database'))\n            .catch((err) => console.error('Error saving cart item:', err));\n        } else {\n          // If the user is not authenticated, save to sessionStorage\n          sessionStorage.setItem('cartItems', JSON.stringify(state.items));\n        }\n      }\n    },    \n\n    removeFromCart: (state, action) => {\n      const { cartItemID, productID, productSize, currentUser } = action.payload;\n    \n      console.log('Removing product:', productID);\n      // Tìm item cần xóa\n      const itemToRemove = state.items.find(\n        (item) => item.product.productID === productID && item.productSize === productSize\n      );\n    \n      if (!itemToRemove) {\n        console.error(\"Item to remove not found in cart\");\n        return;\n      }\n      \n      // Cập nhật state.items\n      state.items = state.items.filter(\n        (item) => item.product.productID !== productID || item.productSize !== productSize\n      );\n    \n      console.log('Current cart items after removal:', state.items);\n        \n      if (currentUser) {\n        axios\n          .delete(`${variables.CART_ITEM_API}/${cartItemID}`)\n          .then(() => console.log('Cart item removed from database'))\n          .catch((err) => console.error('Error removing cart item:', err));\n      } else {\n        sessionStorage.setItem('cartItems', JSON.stringify(state.items));\n      }\n    \n      // Tự động tính lại subtotal, delivery, và total sau khi xóa\n      const subtotal = state.items.reduce(\n        (acc, item) => acc + item.price * item.quantity,\n        0\n      );\n      state.subtotal = subtotal;\n      state.delivery = subtotal >= DELIVERY_THRESHOLD ? 0 : 60;\n      state.total = subtotal + state.delivery - state.subtotal * state.discount;\n    },        \n\n    updateQuantity: (state, action) => {\n      const { cartItemID, customerID, product, productPrice, productSizeID, productSize, quantity, currentUser } = action.payload;\n      // Find the index of the item in the cart\n      const cartItemIndex = state.items.findIndex(\n        (item) => item.product.productID === product.productID && item.productSize === productSize\n      );\n      \n      if (cartItemIndex !== -1) {\n        // Update the quantity of the existing item (create a new state for immutability)\n        state.items[cartItemIndex] = {\n          ...state.items[cartItemIndex],\n          quantity: quantity,\n        };\n            \n        if (currentUser) {\n          // Only update the specific cart item in the database\n          const updatedCartItem = state.items[cartItemIndex];\n      \n          const updatedItem = {\n            cartItemID: updatedCartItem.cartItemID,\n            customerID: currentUser.customerID,\n            productSizeID: productSizeID,\n            quantity: updatedCartItem.quantity,\n          };\n      \n          // Send the updated cart item to the server\n          axios\n            .put(`${variables.CART_ITEM_API}/${updatedCartItem.cartItemID}`, updatedItem)\n            .then(() => console.log('Cart item updated in database'))\n            .catch((err) => console.error('Error updating cart item:', err));\n        } else {\n          // If the user is not authenticated, update sessionStorage\n          sessionStorage.setItem('cartItems', JSON.stringify(state.items));\n        }\n      }\n    },\n      \n\n    clearCart: (state, action) => {\n      const { currentUser } = action.payload;\n      state.items = [];\n\n      if (currentUser) {\n        axios\n          .delete(`${variables.CART_API}`)\n          .then(() => console.log('Cart cleared in database'))\n          .catch((err) => console.error('Error clearing cart:', err));\n      } else {\n        sessionStorage.removeItem('cartItems');\n      }\n    },\n\n    calculateSubtotal: (state) => {\n      const subtotal = state.items.reduce(\n        (acc, item) => acc + item.productPrice * item.quantity,\n        0\n      );\n\n      if (subtotal >= DELIVERY_THRESHOLD) {\n        state.delivery = 0;\n        state.subtotal = subtotal;\n      } else {\n        state.delivery = 60;\n        state.subtotal = subtotal;\n      }\n    },\n\n    updateDelivery: (state, action) => {\n      state.delivery = action.payload.deliveryCost;\n    },\n\n    applyDiscount: (state, action) => {\n      state.discount = action.payload.discount;\n    },\n\n    getTotal: (state) => {\n      state.total = state.subtotal - state.subtotal * state.discount + state.delivery;\n    },\n  },\n  extraReducers: (builder) => {\n    builder.addCase(loadCart.fulfilled, (state, action) => {\n      console.log('Cart loaded from database:', action.payload);\n      state.items = action.payload;\n    });\n  },\n});\n\nexport const {\n  addToCart,\n  removeFromCart,\n  updateQuantity,\n  clearCart,\n  calculateSubtotal,\n  updateDelivery,\n  applyDiscount,\n  getTotal,\n} = cartSlice.actions;\n\nexport default cartSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}