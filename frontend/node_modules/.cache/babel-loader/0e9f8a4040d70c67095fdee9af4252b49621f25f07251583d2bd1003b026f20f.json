{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { addToCart, removeFromCart, updateQuantity, calculateSubtotal, getTotal, applyDiscount, clearCart, loadCart } from '../../store/reducers/cartSlice';\nimport { formatPrice } from './useUtil';\nimport { selectCurrentUser } from '../../store/reducers/userSlice';\nexport const useCart = () => {\n  _s();\n  const dispatch = useDispatch();\n  const items = useSelector(state => state.cart.items);\n  const subtotal = useSelector(state => state.cart.subtotal);\n  const delivery = useSelector(state => state.cart.delivery);\n  const discount = useSelector(state => state.cart.discount);\n  const total = useSelector(state => state.cart.total);\n  const quantity = items.reduce((acc, item) => acc + item.quantity, 0);\n  console.log(\"items\", items);\n  const currentUser = useSelector(selectCurrentUser);\n  useEffect(() => {\n    dispatch(loadCart(currentUser));\n  }, [dispatch, currentUser]);\n  useEffect(() => {\n    dispatch(calculateSubtotal());\n  }, [items, dispatch, quantity]);\n  useEffect(() => {\n    dispatch(getTotal());\n  }, [subtotal, delivery, dispatch, discount]);\n  const addToCartHandler = item => {\n    dispatch(addToCart({\n      cartItemID: items.cartItemID,\n      cartID: items.cartID,\n      productID: items.productID,\n      productName: items.productName,\n      productPrice: items.productPrice,\n      productSizeID: items.productSizeID,\n      productSize: items.productSize,\n      quantity: items.quantity,\n      currentUser\n    }));\n  };\n  const removeFromCartHandler = (itemId, size) => {\n    const item = items.find(item => item.product.productID === itemId);\n    console.log(item);\n    dispatch(removeFromCart({\n      productID: item.productID,\n      currentUser\n    }));\n  };\n  const updateQuantityHandler = (productId, size, newQuantity) => {\n    if (newQuantity === 0) {\n      const item = items.find(item => item.product.productID === productId && item.size === size);\n      if (item) {\n        dispatch(removeFromCart({\n          product: items.productID,\n          currentUser\n        }));\n      }\n    } else if (newQuantity <= 10) {\n      dispatch(updateQuantity({\n        cartItemID: items.cartItemID,\n        cartID: items.cartID,\n        productID: items.productID,\n        productName: items.productName,\n        productPrice: items.productPrice,\n        productSizeID: items.productSizeID,\n        productSize: items.productSize,\n        quantity: items.quantity,\n        currentUser\n      }));\n    }\n  };\n  const clearCartHandler = () => {\n    dispatch(clearCart({\n      currentUser\n    }));\n  };\n  const applyDiscountHandler = discountCode => {\n    const discount = 0.1;\n    if (discountCode.toLowerCase() === \"10off\") {\n      dispatch(applyDiscount({\n        discount\n      }));\n    } else {\n      alert(\"Wrong discount\");\n    }\n  };\n  return {\n    addToCart: addToCartHandler,\n    removeFromCart: removeFromCartHandler,\n    updateQuantity: updateQuantityHandler,\n    clearCart: clearCartHandler,\n    applyDiscount: applyDiscountHandler,\n    items,\n    defaultSubtotal: subtotal,\n    defaultTotal: total,\n    subtotal: formatPrice(subtotal),\n    delivery: formatPrice(delivery),\n    total: formatPrice(total),\n    quantity,\n    discount\n  };\n};\n_s(useCart, \"wN2Hzs1KzQZE12n1rnU+HSz3bWg=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector];\n});","map":{"version":3,"names":["useEffect","useDispatch","useSelector","addToCart","removeFromCart","updateQuantity","calculateSubtotal","getTotal","applyDiscount","clearCart","loadCart","formatPrice","selectCurrentUser","useCart","_s","dispatch","items","state","cart","subtotal","delivery","discount","total","quantity","reduce","acc","item","console","log","currentUser","addToCartHandler","cartItemID","cartID","productID","productName","productPrice","productSizeID","productSize","removeFromCartHandler","itemId","size","find","product","updateQuantityHandler","productId","newQuantity","clearCartHandler","applyDiscountHandler","discountCode","toLowerCase","alert","defaultSubtotal","defaultTotal"],"sources":["C:/Users/Surface/Documents/Pal/myproject/ecommerce-app-ms-sql-net-react-main/frontend/src/utils/hooks/useCart.js"],"sourcesContent":["import { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { addToCart, removeFromCart, updateQuantity, calculateSubtotal, getTotal, applyDiscount, clearCart, loadCart } from '../../store/reducers/cartSlice';\nimport { formatPrice } from './useUtil';\nimport { selectCurrentUser } from '../../store/reducers/userSlice';\n\nexport const useCart = () => {\n  const dispatch = useDispatch();\n  const items = useSelector(state => state.cart.items);\n  const subtotal = useSelector(state => state.cart.subtotal);\n  const delivery = useSelector(state => state.cart.delivery);\n  const discount = useSelector(state => state.cart.discount);\n  const total = useSelector(state => state.cart.total);\n  const quantity = items.reduce((acc, item) => acc + item.quantity, 0);\n\n  console.log(\"items\", items);\n\n  const currentUser = useSelector(selectCurrentUser);\n\n  useEffect(() => {\n    dispatch(loadCart(currentUser));  \n  }, [dispatch, currentUser]);\n\n  useEffect(() => {\n    dispatch(calculateSubtotal());\n  }, [items, dispatch, quantity]);\n\n  useEffect(() => {\n    dispatch(getTotal());\n  }, [subtotal, delivery, dispatch, discount]);\n\n  const addToCartHandler = (item) => {\n    dispatch(addToCart({ cartItemID: items.cartItemID, cartID: items.cartID, productID: items.productID, productName: items.productName, productPrice: items.productPrice, productSizeID: items.productSizeID, productSize: items.productSize, quantity: items.quantity, currentUser }));\n  };\n  \n  const removeFromCartHandler = (itemId, size) => {\n    const item = items.find((item) => item.product.productID === itemId); \n    console.log(item)\n    dispatch(removeFromCart({ productID: item.productID, currentUser }));\n  };\n  \n  const updateQuantityHandler = (productId, size, newQuantity) => {\n    if (newQuantity === 0) {\n      const item = items.find((item) => item.product.productID === productId && item.size === size);\n      if (item) {\n        dispatch(removeFromCart({ product: items.productID , currentUser}));\n      }\n    } else if (newQuantity <= 10) {\n      dispatch(updateQuantity({ cartItemID: items.cartItemID, cartID: items.cartID, productID: items.productID, productName: items.productName, productPrice: items.productPrice, productSizeID: items.productSizeID, productSize: items.productSize, quantity: items.quantity, currentUser }));\n    }\n  };\n\n  const clearCartHandler = () => {\n    dispatch(clearCart({currentUser}));\n  };\n\n  const applyDiscountHandler = (discountCode) => {\n    const discount = 0.1;\n    if(discountCode.toLowerCase() === \"10off\"){\n      dispatch(applyDiscount({ discount }));\n    } else{\n      alert(\"Wrong discount\")\n    }\n  }; \n\n  return { \n    addToCart: addToCartHandler, \n    removeFromCart: removeFromCartHandler, \n    updateQuantity: updateQuantityHandler, \n    clearCart: clearCartHandler, \n    applyDiscount: applyDiscountHandler,\n    items, \n    defaultSubtotal: subtotal,\n    defaultTotal: total, \n    subtotal: formatPrice(subtotal), \n    delivery: formatPrice(delivery), \n    total: formatPrice(total), \n    quantity,\n    discount\n  };\n};\n\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}